<div class="container">
  <h2 class="page-title">Menú del restaurante</h2>

// Si no hay menú, mostrar mensaje
@if(!isOwner) {
    <div class="filter-container">
      <select class="category-select" [(ngModel)]="selectedCategory">
        <option value="">Todas las categorías</option>
        @for(cat of categoryList; track cat.id) {
          <option [value]="cat.id">{{ cat.name }}</option>
        }
      </select>
    </div>
  }

// Mostrar los items del menú
@if(menu && filteredItems.length > 0) {
    <div class="menu-grid">
      
      @for(item of filteredItems; track item.id){
        
        <div class="menu-card" [class.highlight-fav]="item.isFavorite">
          <div class="card-content">
            <div class="card-header">
              <h3 class="product-name">{{ item.name }}</h3>
              
              <button 
                class="btn-favorite" 
                [class.active]="item.isFavorite" 
                (click)="toggleFavorite($event, item.id)" 
                title="Agregar a favoritos">
                <i class="{{ item.isFavorite ? 'fa-solid fa-heart' : 'fa-regular fa-heart' }}"></i>
              </button>
            </div>

            <div class="badges-container">
              @if(item.isHappyHour) {
                <span class="badge badge-happy">
                  <i class="fa-regular fa-clock"></i> Happy Hour
                </span>
              }
              @if(item.discount && item.discount > 0) {
                <span class="badge badge-discount">
                  <i class="fa-regular fa-tag"></i> {{ item.discount }}% OFF
                </span>
              }
            </div>
            
            <div class="price-row">
              @if(item.discount && item.discount > 0) {
                <span class="old-price">$ {{ item.price | number:'1.0-0' }}</span>
                <span class="new-price">$ {{ item.price - (item.price * item.discount / 100) | number:'1.0-0' }}</span>
              } @else {
                <p class="regular-price">$ {{ item.price | number:'1.0-0' }}</p>
              }
            </div>
          
            <span class="link-detail" (click)="viewDetail(item.id)">
              Ver detalle <i class="fa-solid fa-arrow-right"></i>
            </span>
          </div>

          @if(isOwner){
            <div class="owner-actions">
              <button class="btn-action btn-edit" (click)="editProduct(item.id)">
                <i class="fa-regular fa-pen-to-square"></i> Editar
              </button>
              <button class="btn-action btn-delete" (click)="deleteProduct(item.id)">
                <i class="fa-regular fa-trash-can"></i> Eliminar
              </button>
            </div>
          }

        </div>
      }
    </div>
  } @else {
    <div class="empty-state">
      @if(selectedCategory !== "") {
        <p>No hay productos en esta categoría.</p>
      } @else {
        <p>No hay productos en el menú todavía.</p>
      }
    </div>
  }

  @if(isOwner){
    <div class="admin-panel">
      <h3><i class="fa-regular fa-screwdriver-wrench"></i> Panel de Administración</h3>
      
      <div class="admin-grid">
        <button class="btn-admin btn-primary" (click)="goToNewProduct()">
          <i class="fa-regular fa-square-plus"></i> Nuevo Producto
        </button>

        <button class="btn-admin btn-secondary" (click)="goToCategories()">
          <i class="fa-regular fa-folder-open"></i> Categorías
        </button>

        <button class="btn-admin btn-danger-outline" (click)="goToProfile()">
          <i class="fa-regular fa-gear"></i> Mi Cuenta
        </button>
      </div>
    </div>
  } @else {
    <div class="fab-container">
    <button class="btn-cart-fab" (click)="goToCart()">
      <i class="fa-regular fa-cart-shopping"></i>
    </button>

    <button class="btn-restaurant" (click)="goToRest()">
      <i class="fa-solid fa-arrow-left"></i>
    </button>
  </div>
}

  <ng-template #noMenu>
    <p>No hay menú disponible.</p>
  </ng-template>
</div>
